
jQuery( function($) {
	$( document ).on( 'click', '.el_content_toggle_field', function() {
		let el = $(this);
		if ( el.prop('checked') === true ) {
			el.closest('.el_content_toggle').children('.el_content_toggle_wrapper').children('.el_content_one_toggle').fadeOut( 300,function() {
				el.closest('.el_content_toggle').children('.el_content_toggle_wrapper').children('.el_content_two_toggle').fadeIn( 300, function() {
					dct_reinit_modules( el );
				} );
			} );
		} else {
			el.closest('.el_content_toggle').children('.el_content_toggle_wrapper').children('.el_content_two_toggle').fadeOut( 300,function() {
				el.closest('.el_content_toggle').children('.el_content_toggle_wrapper').children('.el_content_one_toggle').fadeIn( 300, function() {
					dct_reinit_modules( el );
				} );
			} );
		}
	} );
	$( document ).on( 'click', '.el_content_toggle_title_value', function() {
		let el = $( this );
		if ( el.hasClass('el_content_toggle_on_value') ) {
			if ( el.closest('.el_content_toggle_button_wrapper').find('.el_content_toggle_field').prop('checked') !== true ) {
				el.closest('.el_content_toggle_button_wrapper').find('.el_content_toggle_field').trigger( 'click' );
			}   
		} else {
			if ( el.closest('.el_content_toggle_button_wrapper').find('.el_content_toggle_field').prop('checked') === true ) {
				el.closest('.el_content_toggle_button_wrapper').find('.el_content_toggle_field').trigger( 'click' );
			}
		}
	} );
} );

function dct_reinit_modules( el ) {
	if ( el.parents('.el_content_toggle').find('.et_pb_gallery').length > 0 ) {
		el.parents('.el_content_toggle').find('.et_pb_gallery').each( function() {
			window.et_pb_gallery_init( jQuery(this) );
		} );
	}
	if ( el.parents('.el_content_toggle').find('.dipl_masonry_gallery').length > 0 ) {
		el.parents('.el_content_toggle').find('.dipl_masonry_gallery').each( function() {
			let $this = jQuery(this).find('.dipl_masonry_gallery_wrapper');
			dct_initiate_isotope( $this, '.dipl_masonry_gallery_item', '.dipl_masonry_gallery_item', '.dipl_masonry_gallery_item_gutter', true );
		} );
	}
	if ( el.parents('.el_content_toggle').find('.el_masonry_gallery').length > 0 ) {
		el.parents('.el_content_toggle').find('.el_masonry_gallery').each( function() {
			let $this = jQuery(this).find('.el_masonry_gallery_wrapper');
			dct_initiate_isotope( $this, '.el_masonry_gallery_item', '.el_masonry_gallery_item', '.el_masonry_gallery_item_gutter', true );
		} );
	}
	if ( el.parents('.el_content_toggle').find('.dipl_woo_products_category_isotope_container').length > 0 ) {
		el.parents('.el_content_toggle').find('.dipl_woo_products_category_isotope_container').each( function() {
			dct_initiate_isotope( jQuery(this), '.dipl_woo_products_category_isotope_item', '.dipl_woo_products_category_isotope_item', '.dipl_woo_products_category_isotope_item_gutter', true );
		} );
	}
	if ( el.parents('.el_content_toggle').find('.dipl_woo_products_isotope_container').length > 0 ) {
		el.parents('.el_content_toggle').find('.dipl_woo_products_isotope_container').each( function() {
			dct_initiate_isotope( jQuery(this), '.dipl_woo_products_isotope_item', '.dipl_woo_products_isotope_item', '.dipl_woo_products_isotope_item_gutter', true );
		} );
	}
	if ( el.parents('.el_content_toggle').find('.dipl_testimonial_isotope_container').length > 0 ) {
		dct_initiate_isotope( el.parents('.dipl_content_toggle').find('.dipl_testimonial_isotope_container'), '.dipl_testimonial_isotope_item' );
	}
	if ( el.parents('.el_content_toggle').find('.dipl_faq_masonry_container').length > 0 ) {
		dct_initiate_isotope( el.parents('.dipl_content_toggle').find('.dipl_faq_masonry_container'), '.dipl_faq_page_schema_item' );
	}
}

function dct_initiate_isotope( $container = '', $itemSelector = '', $columnWidth = '', $gutter = '', $imagesLoaded = false ) {
	if ( '' === $container || '' === $itemSelector ) {
		return '';
	}

	let $masonry = {};
	if ( '' !== $columnWidth && '' !== $gutter ) {
		$masonry = {
			columnWidth: $columnWidth,
			gutter: $gutter
		}
	}

	// options
	let $isotope = $container.isotope( {
		itemSelector: $itemSelector,
		layoutMode: 'masonry',
		percentPosition: true,
		resize: true,
		masonry: $masonry
	} );

	$isotope.isotope( 'revealItemElements', $container.find($itemSelector) );
	if ( $imagesLoaded ) {
		$isotope.imagesLoaded().progress( function() {
			$isotope.isotope('layout');
			$isotope.isotope('reloadItems');
		} );
	}
}
